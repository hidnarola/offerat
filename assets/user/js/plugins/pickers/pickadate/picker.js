!function(e){"function"==typeof define&&define.amd?define("picker",["jquery"],e):"object"==typeof exports?module.exports=e(require("jquery")):this.Picker=e(jQuery)}(function(e){var t=e(window),n=e(document),o=e(document.documentElement);function r(t,d,c,s){if(!t)return r;var u=!1,f={id:t.id||"P"+Math.abs(~~(Math.random()*new Date))},l=c?e.extend(!0,{},c.defaults,s):s||{},p=e.extend({},r.klasses(),l.klass),m=e(t),g=function(){return this.start()},h=g.prototype={constructor:g,$node:m,start:function(){return f&&f.start?h:(f.methods={},f.start=!0,f.open=!1,f.type=t.type,t.autofocus=t==document.activeElement,t.readOnly=!l.editable,t.id=t.id||f.id,"text"!=t.type&&(t.type="text"),h.component=new c(h,l),h.$root=e(r._.node("div",v(),p.picker,'id="'+t.id+'_root"')),h.$root.on({focusin:function(e){h.$root.removeClass(p.focused),e.stopPropagation()},"mousedown click":function(n){var o=n.target;o!=h.$root.children()[0]&&(n.stopPropagation(),"mousedown"!=n.type||e(o).is(":input")||"OPTION"==o.nodeName||(n.preventDefault(),t.focus()))}}).on("click","[data-pick], [data-nav], [data-clear]",function(){var n=e(this),o=n.data(),i=n.hasClass(p.navDisabled)||n.hasClass(p.disabled),a=document.activeElement;a=a&&(a.type||a.href)&&a,(i||a&&!e.contains(h.$root[0],a))&&t.focus(),o.nav&&!i?h.set("highlight",h.component.item.highlight,{nav:o.nav}):r._.isInteger(o.pick)&&!i?h.set("select",o.pick).close(!0):o.clear&&h.clear().close(!0)}).on("click","[data-close]",function(){h.close(!0)}),a(h.$root[0],"hidden",!0),l.formatSubmit&&function(){var n;!0===l.hiddenName?(n=t.name,t.name=""):n=(n=["string"==typeof l.hiddenPrefix?l.hiddenPrefix:"","string"==typeof l.hiddenSuffix?l.hiddenSuffix:"_submit"])[0]+t.name+n[1];h._hidden=e('<input type=hidden name="'+n+'"'+(t.id?'id="'+t.id+'_hidden"':"")+(m.data("value")||t.value?' value="'+h.get("select",l.formatSubmit)+'"':"")+">")[0],m.on("change."+f.id,function(){h._hidden.value=t.value?h.get("select",l.formatSubmit):""}).after(h._hidden)}(),function(){m.data(d,h).addClass(p.input).val(m.data("value")?h.get("select",l.format):t.value).on("focus."+f.id+" click."+f.id,_),l.editable||m.on("keydown."+f.id,function(e){var t=e.keyCode,n=/^(8|46)$/.test(t);if(27==t)return h.close(),!1;(32==t||n||!f.open&&h.component.key[t])&&(e.preventDefault(),e.stopPropagation(),n?h.clear().close():h.open())});a(t,{haspopup:!0,expanded:!1,readonly:!1,owns:t.id+"_root"+(h._hidden?" "+h._hidden.id:"")})}(),l.container?e(l.container).append(h.$root):m.after(h.$root),h.on({start:h.component.onStart,render:h.component.onRender,stop:h.component.onStop,open:h.component.onOpen,close:h.component.onClose,set:h.component.onSet}).on({start:l.onStart,render:l.onRender,stop:l.onStop,open:l.onOpen,close:l.onClose,set:l.onSet}),u=function(e){var t,n="position";e.currentStyle?t=e.currentStyle[n]:window.getComputedStyle&&(t=getComputedStyle(e)[n]);return"fixed"==t}(h.$root.children()[0]),t.autofocus&&h.open(),h.trigger("start").trigger("render"))},render:function(e){return e?h.$root.html(v()):h.$root.find("."+p.box).html(h.component.nodes(f.open)),h.trigger("render")},stop:function(){return f.start?(h.close(),h._hidden&&h._hidden.parentNode.removeChild(h._hidden),h.$root.remove(),m.removeClass(p.input).removeData(d),setTimeout(function(){m.off("."+f.id)},0),t.type=f.type,t.readOnly=!1,h.trigger("stop"),f.methods={},f.start=!1,h):h},open:function(d){return f.open?h:(m.addClass(p.active),a(t,"expanded",!0),setTimeout(function(){h.$root.addClass(p.opened),a(h.$root[0],"hidden",!1)},0),!1!==d&&(f.open=!0,u&&o.css("overflow","hidden").css("padding-right","+="+i()),m.trigger("focus"),n.on("click."+f.id+" focusin."+f.id,function(e){var n=e.target;n!=t&&n!=document&&3!=e.which&&h.close(n===h.$root.children()[0])}).on("keydown."+f.id,function(n){var o=n.keyCode,i=h.component.key[o],a=n.target;27==o?h.close(!0):a!=t||!i&&13!=o?e.contains(h.$root[0],a)&&13==o&&(n.preventDefault(),a.click()):(n.preventDefault(),i?r._.trigger(h.component.key.go,h,[r._.trigger(i)]):h.$root.find("."+p.highlighted).hasClass(p.disabled)||h.set("select",h.component.item.highlight).close())})),h.trigger("open"))},close:function(e){return e&&(m.off("focus."+f.id).trigger("focus"),setTimeout(function(){m.on("focus."+f.id,_)},0)),m.removeClass(p.active),a(t,"expanded",!1),setTimeout(function(){h.$root.removeClass(p.opened+" "+p.focused),a(h.$root[0],"hidden",!0)},0),f.open?(f.open=!1,u&&o.css("overflow","").css("padding-right","-="+i()),n.off("."+f.id),h.trigger("close")):h},clear:function(e){return h.set("clear",null,e)},set:function(t,n,o){var r,i,a=e.isPlainObject(t),d=a?t:{};if(o=a&&e.isPlainObject(n)?n:o||{},t){a||(d[t]=n);for(r in d)i=d[r],r in h.component.item&&(void 0===i&&(i=null),h.component.set(r,i,o)),"select"!=r&&"clear"!=r||m.val("clear"==r?"":h.get(r,l.format)).trigger("change");h.render()}return o.muted?h:h.trigger("set",d)},get:function(e,n){if(null!=f[e=e||"value"])return f[e];if("value"==e)return t.value;if(e in h.component.item){if("string"==typeof n){var o=h.component.get(e);return o?r._.trigger(h.component.formats.toString,h.component,[n,o]):""}return h.component.get(e)}},on:function(t,n,o){var r,i,a=e.isPlainObject(t),d=a?t:{};if(t){a||(d[t]=n);for(r in d)i=d[r],o&&(r="_"+r),f.methods[r]=f.methods[r]||[],f.methods[r].push(i)}return h},off:function(){var e,t,n=arguments;for(e=0,namesCount=n.length;e<namesCount;e+=1)(t=n[e])in f.methods&&delete f.methods[t];return h},trigger:function(e,t){var n=function(e){var n=f.methods[e];n&&n.map(function(e){r._.trigger(e,h,[t])})};return n("_"+e),n(e),h}};function v(){return r._.node("div",r._.node("div",r._.node("div",r._.node("div",h.component.nodes(f.open),p.box),p.wrap),p.frame),p.holder)}function _(e){e.stopPropagation(),"focus"==e.type&&h.$root.addClass(p.focused),h.open()}return new g}function i(){if(o.height()<=t.height())return 0;var n=e('<div style="visibility:hidden;width:100px" />').appendTo("body"),r=n[0].offsetWidth;n.css("overflow","scroll");var i=e('<div style="width:100%" />').appendTo(n)[0].offsetWidth;return n.remove(),r-i}function a(t,n,o){if(e.isPlainObject(n))for(var r in n)d(t,r,n[r]);else d(t,n,o)}function d(e,t,n){e.setAttribute(("role"==t?"":"aria-")+t,n)}return r.klasses=function(e){return{picker:e=e||"picker",opened:e+"--opened",focused:e+"--focused",input:e+"__input",active:e+"__input--active",holder:e+"__holder",frame:e+"__frame",wrap:e+"__wrap",box:e+"__box"}},r._={group:function(e){for(var t,n="",o=r._.trigger(e.min,e);o<=r._.trigger(e.max,e,[o]);o+=e.i)t=r._.trigger(e.item,e,[o]),n+=r._.node(e.node,t[0],t[1],t[2]);return n},node:function(t,n,o,r){return n?(n=e.isArray(n)?n.join(""):n,"<"+t+(o=o?' class="'+o+'"':"")+(r=r?" "+r:"")+">"+n+"</"+t+">"):""},lead:function(e){return(e<10?"0":"")+e},trigger:function(e,t,n){return"function"==typeof e?e.apply(t,n||[]):e},digits:function(e){return/\d/.test(e[1])?2:1},isDate:function(e){return{}.toString.call(e).indexOf("Date")>-1&&this.isInteger(e.getDate())},isInteger:function(e){return{}.toString.call(e).indexOf("Number")>-1&&e%1==0},ariaAttr:function(t,n){e.isPlainObject(t)||(t={attribute:n});n="";for(var o in t){var r=("role"==o?"":"aria-")+o,i=t[o];n+=null==i?"":r+'="'+t[o]+'"'}return n}},r.extend=function(t,n){e.fn[t]=function(o,i){var a=this.data(t);return"picker"==o?a:a&&"string"==typeof o?r._.trigger(a[o],a,[i]):this.each(function(){e(this).data(t)||new r(this,t,n,o)})},e.fn[t].defaults=n.defaults},r});